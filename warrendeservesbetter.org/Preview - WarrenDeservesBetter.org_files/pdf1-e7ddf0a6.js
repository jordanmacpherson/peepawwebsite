define("@widget/PDF/pdf1-e7ddf0a6.js",["exports"],(function(e){"use strict";function t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},a.apply(this,arguments)}const{PropTypes:o}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless;var r={__proto__:null,sectionTitle:o.Text.maxCount(60),heading:o.Text.maxCount(60),description:o.RichText,downloadLink:o.Text.maxCount(60),staticContent:o.object.readOnly,renderMode:o.string.readOnly,isMobile:o.bool.readOnly,documents:o.arrayOf(o.shape({type:o.string,path:o.string,displayName:o.Text.maxCount(100)})).kind("SingleFile")};const{selectors:{I18N:l,Config:n}}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless;var c={__proto__:null,sectionTitle:l.get("defaultSectionTitle"),downloadLink:l.get("defaultDownloadLink"),staticContent:l.staticContent,renderMode:n.renderMode,isMobile:n.isMobile,documents:[],uploadedWithMediaManager:n.flag("uploadFilesWithImageManager")};class i extends(global.Core||guac["@wsb/guac-widget-core"]).Maniless.Widget{}t(i,"propTypes",{...(global.Core||guac["@wsb/guac-widget-core"]).Maniless.Widget.propTypes,...r}),t(i,"defaultProps",{...(global.Core||guac["@wsb/guac-widget-core"]).Maniless.Widget.defaultProps,...c});var s="sectionTitle",g="heading",d="description",u="downloadLink",p=(global.keyMirror||guac.keymirror)({PDF_SECTION_TITLE_RENDERED:null,PDF_HEADING_RENDERED:null,PDF_DESCRIPTION_RENDERED:null,PDF_DOWNLOAD_LINK_RENDERED:null,PDF_PREVIEW_RENDERED:null,PDF_PREV_BTN_RENDERED:null,PDF_NEXT_BTN_RENDERED:null,PDF_PAGE_NOTATION_RENDERED:null,PDF_NONDISPLAY_PLACEHOLDER_RENDERED:null,PDF_DISPLAY_PLACEHOLDER_RENDERED:null,PDF_LINK_OVERLAY:null,PDF_LOADING_ANIMATION:null});class b extends(global.React||guac.react).Component{renderSubheading(){const{heading:e}=this.props;return e?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{typography:"HeadingDelta","data-aid":p.PDF_HEADING_RENDERED,"data-route":g},e):null}renderDescription(){const{description:e}=this.props;return e?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{richtext:!0,style:{textAlign:"center"},"data-aid":p.PDF_DESCRIPTION_RENDERED,"data-route":d},e):null}renderDownloadLink(){const{downloadLink:e,pdfUrl:t}=this.props,a=(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString({eid:"ux2.pdf.download_link.click",type:"click"});return t&&e?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.MoreLink.Forward,{target:"_blank",href:t,"data-aid":p.PDF_DOWNLOAD_LINK_RENDERED,"data-route":u,"data-tccl":a,children:e,style:{display:"inline-flex",alignItems:"center"}}):null}render(){return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Grid.Cell,{inset:!0},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:{marginBottom:"xxlarge",textAlign:"center","> :not(:last-child)":{marginBottom:"small"},"@xs-only":{marginBottom:"large"}}},this.renderSubheading(),this.renderDescription(),this.renderDownloadLink()))}}b.propTypes={description:(global.PropTypes||guac["prop-types"]).string,heading:(global.PropTypes||guac["prop-types"]).string,downloadLink:(global.PropTypes||guac["prop-types"]).string,pdfUrl:(global.PropTypes||guac["prop-types"]).string};const{PUBLISH:m}=(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes;class w extends(global.React||guac.react).Component{constructor(){super(...arguments),t(this,"loadPDFJS",(()=>{"undefined"!=typeof window&&window.pdfjsLib?this.renderPage(this.state.pageNum):(this.scriptEl=document.createElement("script"),this.scriptEl.src="https://img1.wsimg.com/blobby/go/static/pdf.js/2.6.347/pdf.min.js",this.scriptEl.onload=this.pdfjsLoaded,document.head.appendChild(this.scriptEl))})),t(this,"pdfjsLoaded",(()=>{pdfjsLib.GlobalWorkerOptions.workerSrc="https://img1.wsimg.com/blobby/go/static/pdf.js/2.6.347/pdf.worker.min.js",this.renderPage(this.state.pageNum)})),t(this,"renderPage",(e=>{const{renderMode:t,pdfUrl:a}=this.props,{pageNumPending:o}=this.state;this.setState({pageRendering:!0}),this.getArrayBuffer(a,(a=>{pdfjsLib.getDocument({data:a}).promise.then((a=>{a.getPage(e).then((r=>{const{isHorizontal:l,renderContext:n}=this.getCanvasProperties(r,e);this.setState({isHorizontal:l,numPages:a.numPages},(()=>{r.render(n).promise.then((()=>{if(null!==o){const e=o;this.setState({pageNumPending:null},(()=>{this.renderPage(e)}))}else if(this.setState({pageRendering:!1}),t===m&&"undefined"!=typeof window){var r,n;const t=(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString({eid:"ux2.pdf.preview.impression",type:"impression",data:{pageNum:`${e}`,numPages:`${a.numPages}`,layout:l?"horizontal":"vertical"}});null===(r=(n=window).logTcclEvent)||void 0===r||r.call(n,null,t)}})).catch((e=>{console.error(e),r&&this.setState({pageRendering:!1})}))}))}))}),(e=>{console.error(e)}))}))})),t(this,"handleKeyDown",(e=>{const{pageNum:t,numPages:a}=this.state,o=e&&(e.keyCode||e.code),r=39===o&&t<a;37===o&&t>1&&this.queueRenderPage(t-1),r&&this.queueRenderPage(t+1)})),this.state={pageNum:1,pageRendering:!1,pageNumPending:null,numPages:0,isHorizontal:!1},this.canvas=(global.React||guac.react).createRef(),this.canvasWrapper=(global.React||guac.react).createRef()}componentDidMount(){this.loadPDFJS();const{isMobile:e}=this.props;void 0!==typeof window&&!e&&window.innerWidth>767&&window.IntersectionObserver&&(this.focusObserver=new window.IntersectionObserver((e=>{e&&e[0]&&e[0].isIntersecting&&e[0].target.focus({preventScroll:!0})})),this.focusObserver.observe(this.canvasWrapper.current))}componentWillUnmount(){this.focusObserver&&this.focusObserver.unobserve(this.canvasWrapper.current)}componentDidUpdate(e){e.pdfUrl!==this.props.pdfUrl&&this.setState({pageNum:1,pageRendering:!1,pageNumPending:null,numPages:0,isHorizontal:!1},(()=>{this.renderPage(1)}))}getArrayBuffer(e,t){const a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=()=>{const e=a.response;if(e)return t(new Uint8Array(e))},a.send(null)}getCanvasProperties(e,t){const a=this.canvas.current,o=e.getViewport({scale:2.5}),r=a.getContext("2d");a.width=o.width,a.height=o.height;return{isHorizontal:1===t?a.width>a.height:this.state.isHorizontal,renderContext:{canvasContext:r,viewport:o}}}renderLoadingState(){const{staticContent:e}=this.props;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{category:"primary",style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"neutralOverlay",position:"absolute",top:"0",width:"100%",color:"accent","> p":{color:"accent"}}},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Loader,{"data-aid":p.PDF_LOADING_ANIMATION}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{children:e.loadingStateMessage}))}renderLinkOverlay(){const{pdfUrl:e}=this.props;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Link,{"data-aid":p.PDF_LINK_OVERLAY,target:"_blank",href:e,style:{display:"block",height:"100%",position:"absolute",top:"0",width:"100%","@sm":{display:"none"}}})}renderPageNavigation(){const{pageNum:e,numPages:t,isHorizontal:a}=this.state,{staticContent:o}=this.props,r=e>1,l=e<t,n={block:{marginTop:"large",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",color:"primary"},button:{display:"inline-flex",outline:"none",alignItems:"center","> *":{color:"primary"}},buttonWrapper:{display:"inline-flex",alignItems:"center"},pipe:{marginHorizontal:"small",backgroundColor:"section"},pageNotation:{color:"primary",lineHeight:"inherit"}},c=(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString({eid:"ux2.pdf.prev_button.click",type:"click",data:{pageNum:""+(e-1),numPages:`${t}`,layout:a?"horizontal":"vertical"}}),i=(global.Core||guac["@wsb/guac-widget-core"]).UX2.utils.TCCLUtils.getTCCLString({eid:"ux2.pdf.next_button.click",type:"click",data:{pageNum:`${e+1}`,numPages:`${t}`,layout:a?"horizontal":"vertical"}});return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:n.block},r&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:n.buttonWrapper},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.MoreLink.Backward,{"data-tccl":c,onClick:this.queueRenderPage.bind(this,e-1),"data-aid":p.PDF_PREV_BTN_RENDERED,children:o.previous,style:n.button,"data-edit-interactive":!0,tabIndex:0,onKeyDown:this.handleKeyDown}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Pipe,{category:"primary",style:n.pipe})),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{style:n.pageNotation,"data-aid":p.PDF_PAGE_NOTATION_RENDERED},`${e}/${t}`),l&&(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:n.buttonWrapper},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Pipe,{category:"primary",style:n.pipe}),(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.MoreLink.Forward,{"data-tccl":i,onClick:this.queueRenderPage.bind(this,e+1),"data-aid":p.PDF_NEXT_BTN_RENDERED,children:o.next,style:n.button,"data-edit-interactive":!0,tabIndex:0,onKeyDown:this.handleKeyDown})))}queueRenderPage(e){const{pageRendering:t}=this.state;this.setState({pageNum:e},(()=>{t?this.setState({pageNumPending:e}):this.renderPage(e)}))}generateStyles(){return{block:{display:"flex",backgroundColor:"section",padding:"xxsmall","> div > canvas":{width:"100%",height:"100%"}},canvasWrapper:{width:"100%",position:"relative",outline:"none"}}}render(){const{section:e}=this.props,{pageNum:t,numPages:a,isHorizontal:o,pageRendering:r}=this.state,l=t>1,n=t<a,c=this.generateStyles(l,n);return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Grid.Cell,{inset:!o},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{section:"default"===e?"alt":"default",style:c.block},(global.React||guac.react).createElement("div",{style:c.canvasWrapper,ref:this.canvasWrapper,tabIndex:0,onKeyDown:this.handleKeyDown},(global.React||guac.react).createElement("canvas",{"data-aid":p.PDF_PREVIEW_RENDERED,ref:this.canvas}),r&&this.renderLoadingState(),this.renderLinkOverlay())),a>1&&this.renderPageNavigation())}}w.propTypes={pdfUrl:(global.PropTypes||guac["prop-types"]).string.isRequired,staticContent:(global.PropTypes||guac["prop-types"]).object,category:(global.PropTypes||guac["prop-types"]).string,section:(global.PropTypes||guac["prop-types"]).string,renderMode:(global.PropTypes||guac["prop-types"]).string,isMobile:(global.PropTypes||guac["prop-types"]).bool};const{Bootstrap:h}=(global.Core||guac["@wsb/guac-widget-core"]).components;class E extends(global.React||guac.react).Component{extractPDFViewerProps(){return(global._||guac.lodash).pick(this.props,(global._||guac.lodash).keys(w.propTypes))}render(){return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,null,(global.React||guac.react).createElement(h.Radpack,a({},this.extractPDFViewerProps(),{Component:w,entry:"@widget/PDF/bs-Component"})))}}const{selectors:{I18N:y}}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless;var C={sectionTitle:{label:y.get("titleForSectionTitle")},heading:{label:y.get("titleForHeading")},description:{label:y.get("titleForDescription")},downloadLink:{label:y.get("titleForLinkText")},documents:{uploadLabel:y.get("titleForUploadButton"),replaceLabel:y.get("titleForReplaceButton"),accept:"application/pdf"},deleteSectionButton:{label:y.get("deleteSectionButton")}};const{PropTypes:D}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless;var P={__proto__:null,deleteSectionButton:D.DeleteButton};const{Widget:R}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless;var f=R.keys(r);const{constants:{routes:_}}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless,N=_.BASE,{Mutator:T,Widget:k}=(global.Core||guac["@wsb/guac-widget-core"]).Maniless,x=k.keys();class L extends T{}t(L,"fields",(global.Core||guac["@wsb/guac-widget-core"]).Maniless.Mutator.mergeFields(P)),t(L,"defaultProps",{...T.defaultProps,...C,routes:{[N]:[x.category,f.documents,f.sectionTitle,f.heading,f.description,f.downloadLink,"deleteSectionButton"]}});var v=(global.Core||guac["@wsb/guac-widget-core"]).Maniless.connect(class extends i{renderSectionTitle(){const{sectionTitle:e}=this.props;return e?(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Heading,{"data-aid":p.PDF_SECTION_TITLE_RENDERED,"data-route":s,tag:"h2"},e):null}renderPlaceholder(){const{staticContent:e,section:t,renderMode:a}=this.props,o={block:{marginBottom:"xxsmall",display:"flex",justifyContent:"center",alignItems:"center",paddingVertical:"small",paddingHorizontal:"medium",backgroundColor:"section"},displayWrapper:{padding:"xxsmall",backgroundColor:"section"}},{PUBLISH:r,PREVIEW:l,DISPLAY:n,ADD:c}=(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes,i=(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:o.block},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Text,{tag:"span",featured:!0,"data-aid":p.PDF_NONDISPLAY_PLACEHOLDER_RENDERED},[r,l].includes(a)?e.placeholderTextPublish:e.placeholderTextEditor)),s=(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Grid.Cell,{inset:!0},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:o.displayWrapper},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Image,{category:"primary",style:o.displayPlaceholder,src:"https:////img1.wsimg.com/isteam/ip/static/example-pdf/examplePDF.png","data-aid":p.PDF_DISPLAY_PLACEHOLDER_RENDERED})));return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Grid,{xs:1,md:12,bottom:!1,section:"default"===t?"alt":"default"},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Grid.Cell,{xs:1,md:8,pushMd:2},[n,c].includes(a)?s:i))}render(){const{category:e,section:t,documents:o}=this.props,r=o&&o.length&&o[0].path&&o[0].path.indexOf("//")>-1,l=r&&o[0].path;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Component.Widget,this.props,(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Group.Section,{category:e,section:t},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Container,null,this.renderSectionTitle(),(global.React||guac.react).createElement(b,a({},this.props,{pdfUrl:l})),r?(global.React||guac.react).createElement(E,a({},this.props,{pdfUrl:l})):this.renderPlaceholder())))}},L);e.Component=v,e.component="@widget/PDF/pdf1",e.default=v,e.hooks="@widget/PDF/hooks",e.id="pdf1",e.src="/home/jenkins/workspace/gdcorp-im/guac-widget-pdf/build-master/src/layouts/pdf1/index.js",e.type="PDF",Object.defineProperty(e,"__esModule",{value:!0})})),"undefined"!=typeof window&&(window.global=window);
//# sourceMappingURL=pdf1-e7ddf0a6.js.map
